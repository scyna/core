context account;

entity account {
    model{
        id: int64 KEY
        email: string INDEX
        name: string
        avatar: string
        password: string
        dob: string
    }

    from CreateAccountRequest{email, name, dob: birthday}
    from Account{email, name, dob: birthday}
    to GetAccountResponse{email, name, dob: birthday}

    GetAccountByEmail: GET(id, email, name, avatar, dob) WHERE(email)
    GetAccountByID: GET(id, email, name, avatar, dob) WHERE(id)
    UpdateAccount: SET(email, name, password) WHERE(id)
    UpdatePassword(id, password): SET(password) WHERE(id)
    CreateAccount: INSERT(id, email, name, password)
    UpsertAccount: UPSERT(id, email, name, password)
}

entity setting{
    model{
        key: string KEY
        value: string
    }

    GetSetting: GET(value) WHERE(key)
    SetSetting: SET(value) WHERE(key)
}

relationship account_has_setting{
    model{
        account_id: int64 FROM
        key: string TO
        active: bool
    }

    ListSettingByAccount: LIST(key) WHERE(account_id)
    ListActiveSettingByAccount: LIST(key) WHERE(account_id, active=true)
}